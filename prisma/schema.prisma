generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =========================
// ENUMS
// =========================

enum UserType {
  OWNER
  ADMIN
  TEACHER
  STUDENT
  PARENT
}

enum AppType {
  PUBLIC
  PRIVATE
}

// =========================
// MODELS
// =========================

// Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† (Ø§Ù„Ù…Ø§Ù„Ùƒ + Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ + Ø¨Ù‚ÙŠØ© Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹)
model User {
  id           Int       @id @default(autoincrement())
  uuid         String    @unique @default(uuid())
  schoolId     Int?
  school       School?   @relation(fields: [schoolId], references: [id])

  userType     UserType
  code         Int?      // ÙƒÙˆØ¯ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© (Ù„Ù„Ø£Ø¯Ù…Ù†/Ø§Ù„Ù…Ø¹Ù„Ù…/Ø§Ù„Ø·Ø§Ù„Ø¨)
  name         String
  phone        String?
 email        String?   @unique 
  passwordHash String
 
  isActive     Boolean   @default(true)
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt   // ğŸ‘ˆ Ø¬Ø¯ÙŠØ¯

  devices      UserDevice[]
}

// Ø§Ù„Ù…Ø¯Ø§Ø±Ø³
model School {
  id               Int       @id @default(autoincrement())
  uuid             String    @unique @default(uuid())

  name             String
  schoolCode       Int       @unique
  appType          AppType

  phone            String?
  email            String?
  logoUrl          String?
  address          String?
  province         String?
  educationType    String?   // Ø­ÙƒÙˆÙ…ÙŠ / Ø£Ù‡Ù„ÙŠ

  ownerNotes       String?   // ØªÙØ§ØµÙŠÙ„ Ø®Ø§ØµØ© ÙŠØ±Ø§Ù‡Ø§ Ø§Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø·

  primaryColor     String?
  secondaryColor   String?
  backgroundColor  String?
  // ğŸ‘ˆ Ø¹Ø¯Ù‘Ø§Ø¯ Ø¹Ø§Ù… Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©
  nextUserCode     Int       @default(1)
  isActive         Boolean   @default(true)
  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt   // ğŸ‘ˆ Ø¬Ø¯ÙŠØ¯

  users            User[]
}


model GradeDictionary {
  id           Int      @id @default(autoincrement())
  uuid         String   @unique @default(uuid())

  code         String   @unique   // Ù…Ø«Ù„ G01
  defaultName  String   // Ù…Ø«Ù„ "Ø§Ù„ØµÙ Ø§Ù„Ø£ÙˆÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ"
  shortName    String?  // Ù…Ø«Ù„ "Ø£.Ø£" Ø£Ùˆ "Ø£.Ø«"   ğŸ‘ˆ NEW
  stage        String?  // ØªÙ…Ù‡ÙŠØ¯ÙŠ/Ø£Ø³Ø§Ø³ÙŠ/Ø«Ø§Ù†ÙˆÙŠ...
  sortOrder    Int      @default(0)
  isActive     Boolean  @default(true)

  createdAt    DateTime @default(now())  // ğŸ‘ˆ Ø¬Ø¯ÙŠØ¯
  updatedAt    DateTime @updatedAt       // ğŸ‘ˆ Ø¬Ø¯ÙŠØ¯

}
// Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† (Ù„Ù€ FCM Ù„Ø§Ø­Ù‚Ø§Ù‹)
model UserDevice {
  id           Int      @id @default(autoincrement())
  userId       Int
  user         User     @relation(fields: [userId], references: [id])

  deviceToken  String   @unique
  deviceType   String   // ANDROID / IOS / WEB
  lastSeenAt   DateTime?
  isActive     Boolean  @default(true)
}
